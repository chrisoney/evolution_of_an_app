extends layout

append head
  //- add page specific styles by appending to the head
  link(rel="stylesheet" href="/stylesheets/index.css")
  //- add page specific js
  script(src="/javascripts/index.js" type="module" defer)

block content
  if (parseInt(mode) === 0)
    h1= title
    p Welcome to your Project Skeleton
  else
    if authenticated
      if (parseInt(mode) >= 3)
        .homepage-content.beige
          .homepage-left
            -const curr_reading = userInfo.Bookshelves.filter(shelf => shelf.name === 'Currently Reading')[0]
            -const curr_reading_story = curr_reading.Stories[0]
            .currently-reading-example-section-container
              .currently-reading-example-title= curr_reading.name
              .currently-reading-example-body-container
                a(href=`/stories/${curr_reading_story.id}`)
                  img(src=curr_reading_story.imageUrl class='currently-reading-example-image')
                .currently-reading-example-details-container
                  .currently-reading-example-story-title= curr_reading_story.title
                  .currently-reading-example-story-author By #{curr_reading_story.author}
              .currently-reading-example-button-section
                a(href=`/users/${user.id}/bookshelves?selected=Want-To-Read` class='currently-reading-section-button') View all books
            -const want_read = userInfo.Bookshelves.filter(shelf => shelf.name === 'Want To Read')[0]
            -const want_read_stories = want_read.Stories.slice(0,3)
            .want-to-read-examples-section-container
              .want-to-read-examples-title= want_read.name
              .want-to-read-story-images-container
                each story in want_read_stories
                  a(href=`/stories/${story.id}`): img(src=story.imageUrl class='want-to-read-story-image')
              .want-to-read-example-button-section
                a(href='/' class='want-to-read-section-button') View all books
            .bookshelves-listing-section-container
              .bookshelves-listing-title Bookshelves
              .bookshelves-listing-shelves-container
                each shelf in userInfo.Bookshelves
                  -const queryVar = shelf.name.split(' ').join('-');
                  a(href=`/users/${user.id}/bookshelves?selected=${queryVar}` class='bookshelves-listing-shelf-container')
                    .shelf-count= shelf.Stories.length
                    .shelf-name= shelf.name
          .homepage-right
            .social-feed-section-container
    else
      .logo-container
        a(href='/' class="logo-link")
          img(src='/images/logo.png' class="auth-logo")
      .header
        img(src='/images/royal.jpg' class="header-image")
        .auth-container
          div.auth-container-title Discover and Read More
          form(action='/users/demo' method='post')
            button(type="submit" class="demo-button") Demo Login
          a(href="/users/signup" class="signup-button") Sign up with email
          div.auth-container-description
            | By creating an account, you agree to 
            b nothing 
            | and are beholden to 
            b no one.
          .login-container
            div.login-description Already a member?
            a(href='/users/login' class="login-text") Sign in
      if (parseInt(mode) >= 3)
        .homepage-content
          .homepage-left
            .currently-reading-examples-container
              div(class='currently-reading-examples-title') Here's what people are reading
              each user in currentlyReadingUsers
                div(class='individual-user-container')
                  div(class='individual-user-container-title') #{user.username} is currently reading
                  div(class="individual-user-images-container")
                    each story in user.Bookshelves[0].Stories
                      a(href=`/stories/${story.id}`)
                        img(src=story.imageUrl class='individual-user-story-image' title=story.title)
          .homepage-right
            .list-container
              div(class='homepage-list-section-title') Love Lists?
              each user in customBookshelfUsers
                -var bookshelf = user.Bookshelves[0]
                div(class='homepage-list-container')
                  div(class='homepage-list-left')
                    div(class='list-section-list-title')= bookshelf.name
                    div(class='list-section-author')= user.username
                  div(class='homepage-list-right')
                    each story in bookshelf.Stories.slice(0, 6)
                      a(href=`/stories/${story.id}`)
                        img(class='homepage-list-right-image' src=story.imageUrl)

